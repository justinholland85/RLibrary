######################################################################################################
#/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\#
# Lib.WeightedQuantiles
#\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/#
######################################################################################################
# equivalent to quantile(type = 1)


Lib.WeightedQuantile   <-  function(X,W,P){
  
  Order               <-   order(X)  
  
  X                   <-  X[Order]
  W                   <-  W[Order]
  
  cW                  <-  cumsum( W  ) / sum(W)
  
  Q                   <-  numeric(0)
  
  for(i in 1:length(P)){
    
    Q[i]   <-  X[min(which(cW >= P[i]))]
    
  }
  
  names(Q)   <-  paste0(P * 100, "%")
  
  return(Q)
  
}
